"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6438],{6438:function(e,a,t){t.d(a,{Z:function(){return O}});var s=t(85893),o=t(67294),i=t(87536),r=t(21609);t(50196);var n=t(56531);t(29308);var l=t(81284),d=t(95309),c=t(29630),u=t(22841),m=t(75158);let x=e=>{let{title:a,values:t,name:o,changeCategory:i,register:r,isDisabled:n}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.ZP,{disablePadding:!0,children:(0,s.jsx)(d.Z,{children:(0,s.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:a})})}),t&&t.map((e,a)=>(0,s.jsx)(l.ZP,{disablePadding:!0,children:(0,s.jsxs)(d.Z,{children:[(0,s.jsx)("input",{type:"hidden",name:"".concat(o,".[").concat(a,"].id"),defaultValue:e.id,...r("".concat(o,".[").concat(a,"].id"))}),(0,s.jsx)(u.Z,{control:(0,s.jsx)(m.Z,{name:"".concat(o,"[").concat(a,"].checked"),disabled:!!n,...r("".concat(o,"[").concat(a,"].checked")),defaultChecked:1==e.checked,onClick:a=>i?i(e.id,!!a.target.checked):null}),label:e.nome})]})},a))]})};var p=t(79139),h=t(49837),f=t(91359),g=t(79072),b=t(72389),j=t(80562),v=t(66136),D=function(e){return(0,s.jsx)("svg",{viewBox:"0 0 20 20",fill:"currentColor",height:"1em",width:"1em",...e,children:(0,s.jsx)("path",{d:"M16.88 9.1A4 4 0 0116 17H5a5 5 0 01-1-9.9V7a3 3 0 014.52-2.59A4.98 4.98 0 0117 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z"})})},I=function(e){return(0,s.jsx)("svg",{viewBox:"0 0 384 512",fill:"currentColor",height:"1em",width:"1em",...e,children:(0,s.jsx)("path",{d:"M320 464c8.8 0 16-7.2 16-16v-32h48v32c0 35.3-28.7 64-64 64H64c-35.35 0-64-28.7-64-64v-32h48v32c0 8.8 7.16 16 16 16h256zm-64-304c-17.7 0-32-14.3-32-32V48H64c-8.84 0-16 7.16-16 16v128H0V64C0 28.65 28.65 0 64 0h165.5c17 0 33.2 6.743 45.2 18.75l90.6 90.55c12 12 18.7 28.2 18.7 45.2V192h-48v-32h-80zM88 224c30.9 0 56 25.1 56 56s-25.1 56-56 56h-8v32c0 8.8-7.16 16-16 16s-16-7.2-16-16V240c0-8.8 7.16-16 16-16h24zm24 56c0-13.3-10.7-24-24-24h-8v48h8c13.3 0 24-10.7 24-24zm48-40c0-8.8 7.2-16 16-16h24c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48h-24c-8.8 0-16-7.2-16-16V240zm32 112h8c8.8 0 16-7.2 16-16v-64c0-8.8-7.2-16-16-16h-8v96zm144-128c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v32h32c8.8 0 16 7.2 16 16s-7.2 16-16 16h-32v48c0 8.8-7.2 16-16 16s-16-7.2-16-16V240c0-8.8 7.2-16 16-16h48z"})})};let y=e=>{let{grupo:a,indexGrupo:t,handleFileSelect:i,handleRemoveAnexo:n}=e,[l,d]=(0,o.useState)(null);console.log("\uD83D\uDE80 ~ selectedItem:",l);let{settings:u}=(0,o.useContext)(v.J6),m=u.mode,x=(0,o.useRef)(null),p=e=>{x.current.click(),d(e)};return(0,o.useEffect)(()=>{x.current.value=""},[i]),(0,s.jsx)(h.Z,{sx:{mt:4},children:(0,s.jsxs)(f.Z,{children:[(0,s.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:a.nome}),(0,s.jsx)(c.Z,{variant:"body2",sx:{mb:2},children:a.descricao}),(0,s.jsx)(g.ZP,{container:!0,spacing:4,children:a.itens.map((e,a)=>{var o;return(0,s.jsx)(g.ZP,{item:!0,xs:12,md:3,children:(0,s.jsxs)("div",{className:"border  ".concat("dark"===m?"border-[#71717B]":"border-[#E1E1E6]"," rounded-lg flex flex-col relative z-10"),children:[(0,s.jsx)("div",{className:"flex items-center justify-center p-2 mt-1 ",children:(0,s.jsx)("p",{className:"font-medium",children:e.nome})}),(0,s.jsx)("div",{className:"flex justify-center items-center cursor-pointer p-1 h-[150px] w-full ",onClick(){e.anexo&&e.anexo.path&&e.anexo.exist?window.open(e.anexo.path,"_blank"):p(e)},children:(0,s.jsx)("div",{className:"flex p-2  justify-center items-center gap-2 rounded-lg w-full h-full m-3 border border-dashed hover:border-[#4A8B57] transition-colors ".concat("dark"===m?" border-[rgba(234, 234, 255, 0.10)]":"rgba(76, 78, 100, 0.12)"),children:(0,s.jsx)("div",{className:"flex items-center gap-3",children:e.anexo&&e.anexo.exist?(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(I,{className:"text-6xl fill-red-500"})})}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,s.jsx)(D,{className:"w-20 h-20 ".concat(e.anexo&&e.anexo.exist?"fill-[#666CFF]":"fill-current")}),(0,s.jsx)("h6",{className:"text-sm font-normal opacity-80",children:"Adicione um arquivo"})]})})})}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-1 p-2 py-3 pl-4",children:[(0,s.jsx)("p",{className:"text-xs opacity-70",children:e.descricao}),(0,s.jsx)(b.Z,{title:1==e.hasPending?"Este item n\xe3o pode mais ser removido pois j\xe1 foi respondido em um formul\xe1rio":"Remover este item",children:(0,s.jsx)(j.Z,{color:"error",onClick:()=>n(e),disabled:!(null===(o=e.anexo)||void 0===o?void 0:o.exist),children:(0,s.jsx)(r.Z,{icon:"tabler:trash-filled"})})})]}),(0,s.jsx)("input",{type:"file",ref:x,style:{display:"none"},onChange:e=>i(e,l)})]})},"".concat(t,"-").concat(a))})})]})})};var Z=t(99070);t(27222);let S=e=>{let{params:a}=e;console.log("\uD83D\uDE80 ~ ReportFornecedor params:",a);let t=Array.from(Array(50).keys()),o=[{id:1,nome:"Bloco ===> ".concat(a.id),itens:[{id:1,item:"Os fornecedores receberam treinamento de BPF e boas pr\xe1ticas de fabrica\xe7\xe3o ?",resultado:"Sim",observacao:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."},{id:2,item:"Existe local pr\xf3prio pra armazenagem dos insumos ?",resultado:"Sim",observacao:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."},{id:3,item:"Os insumos s\xe3o armazenados em local adequado ?",resultado:"Sim",observacao:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."}]},{id:2,nome:"Bloco 2 UPPPP",itens:[{id:1,item:"Os fornecedores receberam treinamento de BPF ?",resultado:"Sim",observacao:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."},{id:2,item:"Existe local pr\xf3prio pra armazenagem dos insumos ?",resultado:"Sim",observacao:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."},{id:3,item:"Os insumos s\xe3o armazenados em local adequado ?",resultado:"Sim",observacao:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."}]}],i=Z.mM.create({table:{fontSize:10},header:{backgroundColor:"#EEE",padding:10,borderTop:"1px solid #ddd",borderLeft:"1px solid #ddd",borderRight:"1px solid #ddd",borderTopLeftRadius:3,borderTopRightRadius:3},body:{width:"100%",borderTop:"1px solid #ddd",borderRight:"1px solid #ddd",borderBottomLeftRadius:3,borderBottomRightRadius:3,marginBottom:10},row:{display:"flex",flexDirection:"row",width:"100%",borderBottom:"1px solid #ddd"},column:{flex:1,padding:10,display:"flex",alignItems:"center",borderLeft:"1px solid #ddd",flexDirection:"row",flexWrap:"wrap",maxWidth:"100%"}});return(0,s.jsx)(Z.G7,{children:(0,s.jsxs)(s.Fragment,{children:[o.map((e,a)=>(0,s.jsxs)(Z.G7,{style:i.table,children:[(0,s.jsx)(Z.xv,{style:i.header,children:e.nome}),(0,s.jsx)(Z.G7,{style:i.body,children:e.itens.map((e,a)=>(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Z.G7,{style:i.row,children:[(0,s.jsx)(Z.G7,{style:{...i.column,flex:.5},children:(0,s.jsx)(Z.xv,{children:e.item})}),(0,s.jsx)(Z.G7,{style:{...i.column,flex:.2},children:(0,s.jsx)(Z.xv,{children:e.resultado})}),(0,s.jsx)(Z.G7,{style:{...i.column,flex:.3},children:(0,s.jsx)(Z.xv,{children:e.observacao})})]},a)}))})]},a)),t.map((e,a)=>(0,s.jsx)(Z.xv,{style:{marginVertical:5},children:"Imprimindo item numero ".concat(a," pq to testando os textos dos relatorios utilizando a lib react-pdf lorem ipsum pq sim haha uash uiashju ksaj usah uashusau usahuash ashu uhasu uahsuhas has uhasu hsauh sahh sauh")},a))]})})};var C=t(19604),P=t(61953),F=t(55343),w=t(11163),E=t.n(w),k=t(46749),z=t(31727),N=t(89191),A=t(60565),R=t(40039),B=t(47842);t(49540);var V=t(86501),L=t(11935),M=t(7071);t(13860),t(57548),t(45061);var T=t(34282);let G=()=>{let{user:e,loggedUnity:a}=(0,o.useContext)(R.V),[t,r]=(0,o.useState)(!1),[l,d]=(0,o.useState)(!1),[u,m]=(0,o.useState)(!1),[b,j]=(0,o.useState)([]),[D,I]=(0,o.useState)(null),[Z,w]=(0,o.useState)([]),[G,O]=(0,o.useState)([]),[W,q]=(0,o.useState)([]),[_,H]=(0,o.useState)([]),[U,Q]=(0,o.useState)([]),[J,K]=(0,o.useState)([]),[X,Y]=(0,o.useState)(""),[$,ee]=(0,o.useState)(!1),[ea,et]=(0,o.useState)(null),[es,eo]=(0,o.useState)(null),[ei,er]=(0,o.useState)(!1),[en,el]=(0,o.useState)(!1),[ed,ec]=(0,o.useState)(!0),[eu,em]=(0,o.useState)({status:!1,errors:[]}),[ex,ep]=(0,o.useState)(!1),[eh,ef]=(0,o.useState)([]),[eg,eb]=(0,o.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),{setTitle:ej,setStorageId:ev,getStorageId:eD}=(0,o.useContext)(A.f),eI=E(),{id:ey}=eI.query,eZ=(0,k.g_)(eI.pathname),eS=(0,k.Lo)(eI.pathname),{settings:eC}=(0,o.useContext)(v.J6),{watch:eP,register:eF,reset:ew,control:eE,getValues:ek,clearErrors:ez,setValue:eN,setError:eA,handleSubmit:eR,formState:{errors:eB}}=(0,i.cI)(),eV=async()=>{try{await z.h.post("/formularios/fornecedor/verifyFormPending/".concat(ey),{parFormularioID:1}).then(e=>{ec(e.data) //! true/false
})}catch(e){console.log(e)}},eL=async t=>{let s={status:t,auth:{usuarioID:e.usuarioID,papelID:e.papelID,unidadeID:a.unidadeID}};try{d(!0),await z.h.post("".concat(eZ,"/changeFormStatus/").concat(ey),s).then(e=>{V.ZP.success(k.OD.successUpdate),d(!1)})}catch(o){console.log(o)}},eM=async()=>{let t={status:{edit:ei,status:X.status},auth:{usuarioID:e.usuarioID,papelID:e.papelID,unidadeID:a.unidadeID}};if(ei)try{d(!0),await z.h.post("".concat(eZ,"/updateFormStatus/").concat(ey),t).then(e=>{V.ZP.success(k.OD.successUpdate),d(!1)})}catch(s){console.log(s)}else V.ZP.error("N\xe3o h\xe1 dados a serem atualizados!")},eT=[{id:1,name:"Formul\xe1rio do fornecedor",component:(0,s.jsx)(S,{params:{id:ey}}),route:"/relatorio/fornecedor/dadosFornecedor",papelID:e.papelID,identification:"01",params:{fornecedorID:ey}}],eG=(e,a)=>{let t=[];null==e||e.map((e,s)=>{eW(e.categorias,a)&&t.push(e)}),K(t)},eO=(e,a)=>{let t=Z.map(t=>t.id===e?{...t,checked:a}:t);w(t),eG(U,t)},eW=(e,a)=>{let t=e.map(e=>e.categoriaID),s=a.filter(e=>e.checked).map(e=>e.id);if(t.length!==s.length)return!1;let o=[...t].sort(),i=[...s].sort();for(let r=0;r<o.length;r++)if(o[r]!==i[r])return!1;return!0},eq=()=>{try{r(!0),ey&&z.h.post("".concat(eZ,"/getData/").concat(ey),{unidadeLogadaID:a.unidadeID}).then(a=>{console.log("getData: ",a.data),j(a.data.fields),w(a.data.categorias),O(a.data.atividades),q(a.data.sistemasQualidade),Q(a.data.blocos),eG(a.data.blocos,a.data.categorias),H(a.data.grupoAnexo),Y(a.data.info),et(a.data.unidade),ew(a.data);let t=k.WR[a.data.info.status];eo(t),eb({status:2==e.papelID&&a.data.info.status<40,message:2==e.papelID?"Esse formul\xe1rio j\xe1 foi conclu\xeddo e enviado pra f\xe1brica, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":"Somente o fornecedor pode alterar as informa\xe7\xf5es deste formul\xe1rio!",messageType:2==e.papelID?"warning":"info"}),r(!1)})}catch(t){console.log(t)}},e_=()=>{eI.push("/formularios/fornecedor/"),V.ZP.error("Voc\xea n\xe3o tem permiss\xf5es para acessar esta p\xe1gina!")},eH=()=>{eJ(),ee(!0),m(!0)},eU=async e=>{e.conclusion=!0,await eR(eQ)(e)},eQ=async function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===s.conclusion&&(t.status=e&&1==e.papelID?s.status:40,t.obsConclusao=s.obsConclusao);let o={form:t,auth:{usuarioID:e.usuarioID,papelID:e.papelID,unidadeID:a.unidadeID}};console.log("\uD83D\uDE80 ~ onSubmit:",o.form);try{d(!0),await eX(),await z.h.put("".concat(eZ,"/updateData/").concat(ey),o).then(e=>{V.ZP.success(k.OD.successUpdate),d(!1)})}catch(i){console.log(i)}},eJ=()=>{ez();let e=!1,a=[];b.forEach((t,s)=>{let o=t.tabela?"header.".concat(t.tabela):"header.".concat(t.nomeColuna),i=ek(o);1!==t.obrigatorio||i||(eA(o,{type:"manual",message:"Campo obrigat\xf3rio"}),a.push(null==t?void 0:t.nomeCampo),e=!0)}),J.forEach((t,s)=>{t.itens.forEach((t,o)=>{let i=ek("blocos[".concat(s,"].itens[").concat(o,"].resposta"));(null==t?void 0:t.obrigatorio)!==1||i||(eA("blocos[".concat(s,"].itens[").concat(o,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push(null==t?void 0:t.nome),e=!0)})}),em({status:e,errors:a})};(0,o.useEffect)(()=>{ej("Formul\xe1rio do Fornecedor"),"edit"==eS?eq():e_(),eV()},[l]),(0,o.useEffect)(()=>{eJ()},[]),(0,o.useEffect)(()=>{ex&&V.ZP.success("Dados copiados com sucesso!")},[ex]);let eK=(e,a)=>{let t=e.target.files[0];console.log("\uD83D\uDE80 ~ selectedFile:",t);let s={...a,anexo:{exist:!0,path:null,file:t,nome:t.name,type:t.type,size:t.size,time:t.lastModified}},o=_.map(e=>e.grupoAnexoID==a.grupoanexoID?{...e,itens:e.itens.map(e=>e.grupoanexoitemID==s.grupoanexoitemID?(console.log("encontrou item"),s):e)}:e);H(o),V.ZP.success("Anexo adicionado, salve para concluir!")},eX=async()=>{let t=new FormData;t.append("usuarioID",e.usuarioID),t.append("unidadeID",a.unidadeID);let s=0;_.forEach((e,a)=>{e.itens.forEach((e,a)=>{e.anexo&&e.anexo.file&&(t.append("pdfFiles",e.anexo.file),t.append("titulo[".concat(s,"]"),e.anexo.nome),t.append("grupoanexoitemID[".concat(s,"]"),e.grupoanexoitemID),s++)})}),eh.forEach((e,a)=>{t.append("arrAnexoRemoved[".concat(a,"]"),e)}),await z.h.post("/formularios/fornecedor/saveAnexo/".concat(ey),t,{headers:{"Content-Type":"multipart/form-data"}})},eY=e=>{ef([...eh,e.grupoanexoitemID]);let a=_.map(a=>a.grupoAnexoID==e.grupoanexoID?{...a,itens:a.itens.map(a=>a.grupoanexoitemID==e.grupoanexoitemID?{...e,anexo:null}:a)}:a);H(a),V.ZP.success("Anexo pr\xe9-removido, salve para concluir!")};return(0,s.jsxs)(s.Fragment,{children:[t?(0,s.jsx)(B.Z,{}):b?(0,s.jsxs)("form",{onSubmit:eR(e=>{eg.status?eQ(e,!1):eM()}),children:[J&&0===J.length&&(0,s.jsx)(C.Z,{severity:"warning",sx:{mb:2},children:"N\xe3o h\xe1 nenhum bloco dispon\xedvel para as categorias selecionadas!"}),!eg.status&&(0,s.jsx)(C.Z,{severity:eg.messageType,sx:{mb:2},children:eg.message}),(0,s.jsxs)(h.Z,{children:[(0,s.jsx)(N.Z,{btnCancel:!0,btnSave:2==e.papelID&&X.status<40,btnSend:1==e.papelID&&X.status>=40||2==e.papelID&&X.status<40,disabledSend:0===J.length,disabledSubmit:0===J.length,disabledPrint:0===J.length,btnPrint:!0,dataReports:eT,handleSubmit:()=>eR(eQ),handleSend:eH,title:"Fornecedor",btnStatus:!0,handleBtnStatus:()=>el(!0)}),(0,s.jsxs)(f.Z,{children:[ea&&(0,s.jsxs)(P.Z,{sx:{mb:4},children:[(0,s.jsx)("input",{type:"hidden",value:ea.unidadeID,name:"unidadeID",...eF("unidadeID")}),(0,s.jsxs)(g.ZP,{container:!0,spacing:4,children:[(0,s.jsxs)(g.ZP,{item:!0,xs:12,md:6,children:[(0,s.jsx)(c.Z,{variant:"caption",children:"F\xe1brica:"}),(0,s.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:ea.nomeFantasia})]}),(0,s.jsx)(g.ZP,{item:!0,xs:12,md:6,children:es&&(0,s.jsx)(P.Z,{display:"flex",alignItems:"center",justifyContent:"flex-end",children:(0,s.jsx)(M.Z,{size:"small",skin:"light",color:es.color,label:es.title,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}})})})]})]}),(0,s.jsx)(n.Z,{fields:b,register:eF,errors:eB,setValue:eN,control:eE,watch:eP,disabled:!eg.status,setCopiedDataContext:ep}),(0,s.jsxs)(g.ZP,{container:!0,spacing:4,children:[(0,s.jsx)(g.ZP,{item:!0,xs:12,md:4,children:(0,s.jsx)(x,{title:"Categorias",values:Z,name:"categorias",changeCategory:eO,register:eF,disabled:!eg.status})}),(0,s.jsx)(g.ZP,{item:!0,xs:12,md:4,children:(0,s.jsx)(x,{title:"Atividades",values:G,name:"atividades",register:eF,disabled:!eg.status})}),(0,s.jsx)(g.ZP,{item:!0,xs:12,md:4,children:(0,s.jsx)(x,{title:"Sistema de Qualidade",values:W,name:"sistemasQualidade",register:eF,disabled:!eg.status})})]})]})]}),J&&J.map((e,a)=>(0,s.jsx)(p.Z,{index:a,blockKey:"parFornecedorBlocoID",values:e,control:eE,register:eF,setValue:eN,errors:eB,disabled:!eg.status},a)),_&&_.map((e,a)=>(0,s.jsx)(y,{grupo:e,indexGrupo:a,handleFileSelect:eK,handleRemoveAnexo:eY},a)),(0,s.jsx)(h.Z,{sx:{mt:4},children:(0,s.jsx)(f.Z,{children:(0,s.jsx)(g.ZP,{container:!0,spacing:4,children:(0,s.jsx)(g.ZP,{item:!0,xs:12,md:12,children:(0,s.jsx)(F.Z,{fullWidth:!0,children:(0,s.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"})})})})})})]}):null,(0,s.jsx)(L.Z,{openModal:$,handleClose(){ee(!1),m(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:X,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:eU,listErrors:eu}),en&&(0,s.jsx)(T.Z,{id:ey,parFormularioID:1,formStatus:X.status,hasFormPending:ed,canChangeStatus:1==e.papelID&&!ed&&X.status>30,openModal:en,handleClose:()=>el(!1),title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(ey," do Fornecedor."),btnCancel:!0,btnConfirm:!0,handleSubmit:eL})]})};var O=G}}]);